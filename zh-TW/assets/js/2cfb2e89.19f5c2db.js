"use strict";(self.webpackChunktouchgfx_documentation=self.webpackChunktouchgfx_documentation||[]).push([[3515],{3905:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return d}});var a=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),c=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=c(e.components);return a.createElement(s.Provider,{value:n},e.children)},p="mdxType",g={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},h=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=c(t),h=r,d=p["".concat(s,".").concat(h)]||p[h]||g[h]||i;return t?a.createElement(d,o(o({ref:n},u),{},{components:t})):a.createElement(d,o({ref:n},u))}));function d(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=h;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[p]="string"==typeof e?e:r,o[1]=l;for(var c=2;c<i;c++)o[c]=t[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}h.displayName="MDXCreateElement"},44035:function(e,n,t){var a=t(67294),r=t(25026);n.Z=function(e){const n=e.noShadow||!1,t=e.width,i=e.height,o=(0,r.Z)(e.imageSource);return n?a.createElement("div",{class:"figure noshadow"},a.createElement("a",{href:o,target:"_blank"},a.createElement("img",{width:t,height:i,src:o})),a.createElement("p",null,e.children)):a.createElement("div",{class:"figure"},a.createElement("a",{href:o,target:"_blank"},a.createElement("img",{width:t,height:i,src:o})),a.createElement("p",null,e.children))}},45568:function(e,n,t){t.r(n),t.d(n,{assets:function(){return m},contentTitle:function(){return d},default:function(){return v},frontMatter:function(){return h},metadata:function(){return f},toc:function(){return y}});var a=t(3905),r=t(44035),i=Object.defineProperty,o=Object.defineProperties,l=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,p=(e,n,t)=>n in e?i(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,g=(e,n)=>{for(var t in n||(n={}))c.call(n,t)&&p(e,t,n[t]);if(s)for(var t of s(n))u.call(n,t)&&p(e,t,n[t]);return e};const h={id:"using-binary-translations",title:"Binary Translations"},d=void 0,f={unversionedId:"development/ui-development/touchgfx-engine-features/using-binary-translations",id:"development/ui-development/touchgfx-engine-features/using-binary-translations",title:"Binary Translations",description:"This section describes how to use binary translations in TouchGFX. Normally text translations are compiled into the application. This principle is efficient and easy to use.",source:"@site/i18n/zh-TW/docusaurus-plugin-content-docs/current/development/ui-development/touchgfx-engine-features/using-binary-translations.mdx",sourceDirName:"development/ui-development/touchgfx-engine-features",slug:"/development/ui-development/touchgfx-engine-features/using-binary-translations",permalink:"/4.16/zh-TW/docs/development/ui-development/touchgfx-engine-features/using-binary-translations",draft:!1,tags:[],version:"current",frontMatter:{id:"using-binary-translations",title:"Binary Translations"},sidebar:"docs",previous:{title:"Font Caching",permalink:"/4.16/zh-TW/docs/development/ui-development/touchgfx-engine-features/font-cache"},next:{title:"Backend Communication",permalink:"/4.16/zh-TW/docs/development/ui-development/touchgfx-engine-features/backend-communication"}},m={},y=[{value:"Translations",id:"translations",level:3},{value:"Configuring the Text converter",id:"configuring-the-text-converter",level:3},{value:"Installing a binary translation",id:"installing-a-binary-translation",level:3}],b={toc:y};function v(e){var n,t=e,{components:i}=t,p=((e,n)=>{var t={};for(var a in e)c.call(e,a)&&n.indexOf(a)<0&&(t[a]=e[a]);if(null!=e&&s)for(var a of s(e))n.indexOf(a)<0&&u.call(e,a)&&(t[a]=e[a]);return t})(t,["components"]);return(0,a.kt)("wrapper",(n=g(g({},b),p),o(n,l({components:i,mdxType:"MDXLayout"}))),(0,a.kt)("p",null,"This section describes how to use binary translations in TouchGFX. Normally text translations are compiled into the application. This principle is efficient and easy to use.",(0,a.kt)("br",{parentName:"p"}),"\n","Binary translations keep the text translation out of the application. The binary translations are generated in separate binary files which can be programmed to flash or for example stored on an sdcard.  This gives more flexibility to application developers when handling a large number of translations."),(0,a.kt)("h3",g({},{id:"translations"}),"Translations"),(0,a.kt)("p",null,"The Text class in TouchGFX contains a pointer array with a pointer to a translation table for each language in the application. A translation table is in principle a collection of all strings used in that language:"),(0,a.kt)(r.Z,{imageSource:"/img/development/ui-development/touchgfx-engine-features/using-binary-fonts/text-class-1.webp",noShadow:"true",width:"420",mdxType:"Figure"},"Mapping texts to specific languages"),(0,a.kt)("p",null,"This table allows TouchGFX to find a given text in the selected language."),(0,a.kt)(r.Z,{imageSource:"/img/development/ui-development/touchgfx-engine-features/using-binary-translations/binary-translation.webp",noShadow:"true",width:"600",mdxType:"Figure"},"Mapping to a binary translation"),(0,a.kt)("p",null,"When using binary translations at runtime you change the mapping from the compiled-in translation to a binary translation. The binary translations must be available in addressable memory (flash or RAM). It can for example be loaded from a disk or written to the flash during production."),(0,a.kt)("h3",g({},{id:"configuring-the-text-converter"}),"Configuring the Text converter"),(0,a.kt)("p",null,'The TouchGFX text converter can be configured to generate binary translations. This is easily done in the TouchGFX Designer 4.13. Go to the Config tab, select "Text Configuration", and click "Binary translation files"'),(0,a.kt)(r.Z,{imageSource:"/img/development/ui-development/touchgfx-engine-features/using-binary-translations/designer-text-config.webp",noShadow:"true",width:"900",mdxType:"Figure"},"Enabling binary translation"),(0,a.kt)("p",null,"When you generate the code the next time, the binary translations will be in the generated/texts/binary folder."),(0,a.kt)("p",null,"The translations compiled into the application are empty when binary translations are generated. Therefore no texts are shown unless you load binary translations."),(0,a.kt)("h3",g({},{id:"installing-a-binary-translation"}),"Installing a binary translation"),(0,a.kt)("p",null,"When the application has the binary translation in memory, it can install it in TouchGFX. Now TouchGFX will use that translation. Depending on the application this can be done in different places or time (The ",(0,a.kt)("em",{parentName:"p"},"FrontendApplication::FrontendApplication(Model& m, FrontendHeap& heap)")," constructor in ",(0,a.kt)("em",{parentName:"p"},"gui/src/common/FrontApplication.cpp")," can e.g. be used)."),(0,a.kt)("p",null,'Here is an example where we read a translation for English from a filesystem and install it as language "GB".'),(0,a.kt)("pre",null,(0,a.kt)("code",g({parentName:"pre"},{className:"language-cpp",metastring:"{11-11,15-15,19-19}","{11-11,15-15,19-19}":!0}),'//read the translation into this global array\nuint8_t translation[10000];\n...\n\n//read the translation from a file, or change array to a pointer that points\n//to the translation data in internal or addressable external flash\nFILE* file = fopen("generated/texts/binary/LanguageGb.bin", "rb");\nif (file)\n{\n    //read data from file\n    fread(translation, 1, 10000, file);\n    fclose(file);\n\n    //replace empty translation with the binary data\n    Texts::setTranslation(GB, translation);\n\n    //always change language to get TouchGFX changed from the\n    //empty translation compiled in to the binary translation\n    Texts::setLanguage(GB);\n}\n')),(0,a.kt)("p",null,"Note, it is necessary to change language after installing a translation. Otherwise TouchGFX will still use the previous translation. Read about changing language ",(0,a.kt)("a",g({parentName:"p"},{href:"texts-and-fonts#switching-language"}),"here"),"."),(0,a.kt)("p",null,"It is also necessary to force a redraw of the current screen, or change screen, to see the new texts (if you are loading translations for the language that is used on the display). TouchGFX does not redraw anything automatically."),(0,a.kt)("p",null,"The current screen can be redrawn by invalidating the root container:"),(0,a.kt)("pre",null,(0,a.kt)("code",g({parentName:"pre"},{className:"language-cpp"}),"container.invalidate();\n")),(0,a.kt)("p",null,'This will force a redraw. In some cases it is better to change the screen to get everything set up again from scratch (e.g. to recalculate TextArea sizes). You can change the screen by creating an interaction in TouchGFX Designer with the "Change Screen" action. See this ',(0,a.kt)("a",g({parentName:"p"},{href:"../designer-user-guide/interactions-view"}),"article"),"."))}v.isMDXComponent=!0}}]);