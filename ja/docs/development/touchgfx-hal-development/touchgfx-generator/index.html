<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-development/touchgfx-hal-development/touchgfx-generator">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="search" type="application/opensearchdescription+xml" title="TouchGFX Documentation" href="/4.16/ja/opensearch.xml">
<script src="/4.16/ja/js/one-trust.js"></script>
<script src="/4.16/js/fix-location.js"></script><title data-rh="true">Generatorユーザ･ガイド | TouchGFX Documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://support.touchgfx.com/4.16/ja/img/meta-image.png"><meta data-rh="true" name="twitter:image" content="https://support.touchgfx.com/4.16/ja/img/meta-image.png"><meta data-rh="true" property="og:url" content="https://support.touchgfx.com/4.16/ja/docs/development/touchgfx-hal-development/touchgfx-generator"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Generatorユーザ･ガイド | TouchGFX Documentation"><link data-rh="true" rel="icon" href="/4.16/ja/img/favicon.png"><link data-rh="true" rel="canonical" href="https://support.touchgfx.com/4.16/ja/docs/development/touchgfx-hal-development/touchgfx-generator"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.16/docs/development/touchgfx-hal-development/touchgfx-generator" hreflang="en"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.16/ko/docs/development/touchgfx-hal-development/touchgfx-generator" hreflang="ko"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.16/ja/docs/development/touchgfx-hal-development/touchgfx-generator" hreflang="ja"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.16/zh-CN/docs/development/touchgfx-hal-development/touchgfx-generator" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.16/zh-TW/docs/development/touchgfx-hal-development/touchgfx-generator" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.16/docs/development/touchgfx-hal-development/touchgfx-generator" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://B8LNOI0XWD-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/4.16/ja/assets/css/styles.d56efc44.css">
<link rel="preload" href="/4.16/ja/assets/js/runtime~main.9f8bc7bd.js" as="script">
<link rel="preload" href="/4.16/ja/assets/js/main.d5c38302.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/4.16/ja/docs/introduction/welcome"><div class="navbar__logo"><img src="/4.16/ja/img/logo.svg" alt="TouchGFX" class="themedImage_ToTc themedImage--light_HNdA"><img src="/4.16/ja/img/logo.svg" alt="TouchGFX" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">日本語</a><ul class="dropdown__menu"><li><a href="/4.16/docs/development/touchgfx-hal-development/touchgfx-generator" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/4.16/ko/docs/development/touchgfx-hal-development/touchgfx-generator" target="_self" rel="noopener noreferrer" class="dropdown__link">한국어</a></li><li><a href="/4.16/ja/docs/development/touchgfx-hal-development/touchgfx-generator" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">日本語</a></li><li><a href="/4.16/zh-CN/docs/development/touchgfx-hal-development/touchgfx-generator" target="_self" rel="noopener noreferrer" class="dropdown__link">简体中文</a></li><li><a href="/4.16/zh-TW/docs/development/touchgfx-hal-development/touchgfx-generator" target="_self" rel="noopener noreferrer" class="dropdown__link">繁體中文</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/4.16/ja/docs/introduction/welcome">4.16</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/4.16/ja/docs/development/touchgfx-hal-development/touchgfx-generator">4.16</a></li><li><a href="https://support.touchgfx.com/4.15" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.15<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.14" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.14<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.13" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.13<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://community.st.com/s/topic/0TO0X0000003iw6WAA/touchgfx" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community</a><a href="https://touchgfx.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">TouchGFX.com</a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4.16/ja/docs/introduction/welcome">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4.16/ja/docs/basic-concepts/embedded-graphics">Basic Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/4.16/ja/docs/development/development-introduction">Development</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/4.16/ja/docs/development/development-introduction">開発の概要</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/4.16/ja/docs/development/hardware-selection/hardware-selection-introduction">Hardware Selection</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/4.16/ja/docs/development/board-bring-up/board-introduction">Board Bring Up</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/4.16/ja/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction">TouchGFX AL Development</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.16/ja/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction">TouchGFX AL（抽象化レイヤ）開発の概要</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.16/ja/docs/development/touchgfx-hal-development/touchgfx-architecture">抽象化レイヤ･アーキテクチャ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/4.16/ja/docs/development/touchgfx-hal-development/touchgfx-generator">Generatorユーザ･ガイド</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/4.16/ja/docs/development/touchgfx-hal-development/scenarios/scenarios-ltdc-parallel-rgb">Scenarios</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/4.16/ja/docs/development/ui-development/ui-development-introduction">UI Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/4.16/ja/docs/development/scenarios/touchgfx-on-lowcost-hardware">Scenarios</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4.16/ja/docs/miscellaneous/updating-to-a-new-touchgfx-version">Miscellaneous</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4.16/ja/docs/tutorials/tutorial-01">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4.16/ja/docs/api/classes/classtouchgfx_1_1_abstract_button">API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4.16/ja/docs/resources/presentations">Resources</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><span class="breadcrumbs__link">Development</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">TouchGFX AL Development</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Generatorユーザ･ガイド</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Generatorユーザ･ガイド</h1></header><p>X-CUBE-TOUCHGFXの一部であるTouchGFX Generatorは、CubeMXの追加ソフトウェア･コンポーネントで、開発者がハードウェア･プラットフォーム上でTouchGFXを実行するための設定を行うのを支援するものです。 既存のCubeMXの設定とユーザ入力に基づいて、TouchGFX Generatorは機能するTouchGFXアプリケーションの設定に必要なファイルを生成します。 ここには、TouchGFX HAL、TouchGFX OSAL、およびTouchGFXの設定ファイルが含まれています。</p><p>CubeMXを介してコードを生成すると、TouchGFX DesignerからTouchGFXプロジェクトを開けるようになり、ここでUIを開発できます。 TouchGFX Designerは、追加生成されたコードのファイルを、CubeMXでプロジェクト用に設定されたターゲットのIDEプロジェクトに自動的に追加します。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="enabling-touchgfx-generator">TouchGFX Generatorの有効化<a class="hash-link" href="#enabling-touchgfx-generator" title="Direct link to heading">​</a></h2><p>次の図は、TouchGFX Generatorが<em>［Additional Software］</em>カテゴリの下ですでに有効化された状態のプロジェクトを示しています。 ユーザは、X-CUBEから［Additional Software］ボタンを押すことで、追加機能にアクセスできます。</p><div class="figure noshadow"><a href="/4.16/ja/img/development/touchgfx-hal-development/enable-generator.webp" target="_blank"><img src="/4.16/ja/img/development/touchgfx-hal-development/enable-generator.webp"></a><p>CubeMXで［Additional Software］を選択</p></div><p>次の図は、プロジェクトに対してTouchGFX Generatorを有効化する方法を示しています。</p><div class="figure noshadow"><a href="/4.16/ja/img/development/touchgfx-hal-development/add-generator.webp" target="_blank"><img src="/4.16/ja/img/development/touchgfx-hal-development/add-generator.webp"></a><p>TouchGFX Generatorの有効化</p></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="generated-code-architecture">生成されるコードのアーキテクチャ<a class="hash-link" href="#generated-code-architecture" title="Direct link to heading">​</a></h2><p>TouchGFX Generatorの機能の説明の前に、生成されるコードのアーキテクチャと、開発者がそれを使用して設定や動作をカスタマイズする方法について理解することが重要です。</p><p>CubeMXで生成するファイル内のユーザ記述のコードは、CubeMX(Cコード) で生成されるコード全体に明示的に配置された<strong>ユーザ･コード</strong>･セクションを使用することで保護されます。TouchGFX Generator（C++コード）で生成されるコードでは、この柔軟性が保持されています。</p><p><em>［Additional Software］</em>でTouchGFX Generatorを追加し、有効化すると、CubeMXは常にそのプロジェクトに<em>TouchGFX</em>フォルダを作成します。 このフォルダには設定に関わらず常に同じファイルが含まれますが、ファイルの内容はCubeMXおよびユーザ設定に応じて変わります。</p><p>次のリストは、TouchGFX Generatorが<em>有効化</em>されたCubeMXプロジェクトの内容の概要を示しており、特にTouchGFX関連ファイルが強調されています。 リストの後の表は、最も重要なエントリの役割を概説しています。</p><div class="code-header"><div><h5>TouchGFX フォルダ</h5></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   .mxproject</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   myproject.ioc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├───Core</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├───Drivers</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├───EWARM</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├───Middlewares</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">└───TouchGFX</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    │   ApplicationTemplate.touchgfx.part</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ├───App</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    │       app_touchgfx.c</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    │       app_touchgfx.h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    └───target</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │   STM32TouchController.cpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │   STM32TouchController.hpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │   TouchGFXGPIO.cpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │   TouchGFXHAL.cpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │   TouchGFXHAL.hpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        └───generated</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                OSWrappers.cpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                TouchGFXConfiguration.cpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                TouchGFXGeneratedHAL.cpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                TouchGFXGeneratedHAL.hpp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>フォルダ</th><th>役割</th></tr></thead><tbody><tr><td>myproject.ioc</td><td>CubeMXプロジェクト･ファイル</td></tr><tr><td>Core</td><td><code>main.c</code> と起動コード</td></tr><tr><td>Drivers</td><td>CMSISとマイクロコントローラ･ファミリのドライバ</td></tr><tr><td>EWARM</td><td>IDEプロジェクト･フォルダ。 EWARM、MDK-ARM、STM32CubeIDEのいずれか</td></tr><tr><td>Middlewares</td><td>TouchGFXライブラリ / ヘッダファイルと、サードパーティ･ソフトウェア（FreeRTOSなど）が含まれます。</td></tr><tr><td>ApplicationTemplate.touchgfx.part</td><td>.partファイルはCubeMXによって、TouchGFX Designerプロジェクトに関連する情報（画面の寸法やビット深度など）で更新されます。</td></tr><tr><td>App</td><td>X-CUBEのCubeMXに対するインタフェース。 <code>app_touchgfx.c</code> には、関数<code>MX_TouchGFX_Process(void)</code>および <code>MX_TouchGFX_Init(void)</code> の定義が含まれます。これらの関数はTouchGFXを初期化してメイン･ループを開始するために使用されます。</td></tr><tr><td>target/generated</td><td>このサブフォルダには、設定変更時にCubeMXによって上書きされる読出し専用ファイルが含まれます。 <code>TouchGFXGeneratedHAL.cpp</code>はTouchGFXクラス<code>HAL</code> のサブクラスで、CubeMXが現在の設定に基づいて生成することのできるコードが含まれます。 <code>OSWrappers.cpp</code>OSAL）にはTouchGFXエンジンとの同期に必要な関数が含まれます。最後に<code>TouchGFXConfiguration.cpp</code> には、TouchGFXの構築および設定のためのコードが含まれます（HALを含む）。</td></tr><tr><td>target</td><td>HALの動作を拡張したりCubeMXによって生成された設定をオーバーライドしたりするためにユーザが変更できるファイルの大部分が含まれています。 <code>STM32TouchController.cpp</code>には、空のタッチ･コントローラ･インタフェースが含まれます。 <code>TouchGFXHAL.cpp</code> は、<code>TouchGFXGeneratedHAL</code>のサブクラス<code>TouchGFXHAL</code>,を定義します。</td></tr></tbody></table><p><code>TouchGFXConfiguration.cpp</code>にはHALを構築する関数とTouchGFXのメイン･ループを開始する関数が含まれることを把握しておくことが重要です。 追加設定は、編集可能なユーザクラス<code>TouchGFXHAL</code>にて行うことができます。 HALの一般的なアーキテクチャは次のようになります。</p><div class="figure noshadow"><a href="/4.16/ja/img/development/touchgfx-hal-development/code-architecture.webp" target="_blank"><img width="200" src="/4.16/ja/img/development/touchgfx-hal-development/code-architecture.webp"></a><p>生成されるコードの階層</p></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="feature-overview">機能の概要<a class="hash-link" href="#feature-overview" title="Direct link to heading">​</a></h2><p>TouchGFX Generatorを有効にすると、ユーザ･インタフェースには次の3つのグループが表示されます。</p><ul><li><strong><em>Dependencies</em></strong> - このグループには依存関係、警告、または設定内の具体的なエラーに関する開発者への通知が含まれます。 エントリが存在しない場合、このグループは非表示になります。</li><li><strong><em>Display</em></strong> - このグループにはディスプレイに関連する設定（インタフェース、フレームバッファのビット深度、幅、高さなど）が含まれます。 これらの設定は、TouchGFXプロジェクトのキャンバスのサイズや、アセット用に生成されるコードに直接影響します。</li><li><strong><em>Driver</em></strong> - このグループでは、アプリケーション、グラフィック･アクセラレーション、RTOSのティック･ソースに関連する多くの既製のドライバに対してユーザがオプトインできます。 CubeMXはFreeRTOS（CMSIS RTOS v1およびv2）の設定をサポートしているため、TouchGFX Generatorはこれらの各オプションに対してドライバを提供します。</li></ul><div class="figure noshadow"><a href="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/three-sections.webp" target="_blank"><img src="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/three-sections.webp"></a><p>TouchGFX Generatorの3つのグループ: Dependencies、Display、Driver</p></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="display">Display<a class="hash-link" href="#display" title="Direct link to heading">​</a></h2><p><em>Display</em> グループには、ディスプレイに関連する設定（インタフェース、寸法、バッファリング戦略など）が含まれます。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="interface-and-dimensions">インタフェースと寸法<a class="hash-link" href="#interface-and-dimensions" title="Direct link to heading">​</a></h3><p>現在、STM32マイクロコントローラでは、次に示すような複数のディスプレイ･インタフェースを使用できます。</p><ul><li>パラレルRGB</li><li>MIPI DSI</li><li>FMC</li><li>SPI</li></ul><p>LTDC搭載マイクロコントローラの場合、<em>TouchGFX Generator</em>は、フレームバッファを接続されたディスプレイに転送するためのドライバを生成できます。 DSI、FMC、およびSPIインタフェースのドライバは、開発者自身で実装する必要があります。</p><div class="highlight highlight-further-reading"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>Further reading</h5></div><div class="highlight-content">さまざまなディスプレイ･インタフェースのドライバの具体例については、「<a href="/4.16/ja/docs/development/touchgfx-hal-development/scenarios/scenarios-ltdc-parallel-rgb">シナリオ</a>を参照してください。</div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="buffering-strategies">Buffering Strategies<a class="hash-link" href="#buffering-strategies" title="Direct link to heading">​</a></h3><p>TouchGFX Generatorを介して、次のフレームバッファ戦略を設定できます。</p><ul><li><strong>Single Buffer</strong>- アプリケーション･フレームバッファを1つだけ使用します。 パフォーマンスが制限される可能性がありますが、メモリの使用量は少なくて済みます。 ［Buffer Location］設定で使用して、内部RAMに配置できます。 さらに最適化するには、ディスプレイ･コントローラによって現在処理されているラインを返す関数をユーザが定義できます。 この方法はフレームワークによって使用され、このフレームですでにディスプレイに転送済みのメモリへの更新ができるようになります。</li><li><strong>Double Buffer</strong> - 2つのフレームバッファを使用します。 通常、多くのメモリを必要としますが、パフォーマンスが向上します。</li><li><strong>Partial Buffer</strong>- 1つ以上のユーザ定義のメモリ領域をフレームバッファとして使用します。 この戦略は外部RAMに頼らないが、ディスプレイのフレームバッファ全体では使用可能なメモリ量を超える可能性がある場合の低コストのソリューションをターゲットにしています。</li></ul><p>シングル・バッファとダブル・バッファの場合、ユーザは［Buffer Location］設定で次のオプションを使用して場所を設定できます。</p><ul><li><strong>By Allocation</strong> - リンカがリンカ･スクリプトに従ってフレームバッファのメモリを配置できます。 デフォルトは内部RAMです。</li><li><strong>By Address</strong> - ユーザが1つ（シングル）または2つ（ダブル）のフレームバッファ･アドレスを定義できます。</li></ul><p><strong>パーシャル・バッファ</strong>戦略では、ユーザは以下のパラメータを定義できます。</p><ul><li>ブロック数(常に内部RAMに配置される)</li><li>ブロック･サイズ(バイト)</li></ul><p>パーシャル･バッファ戦略に関する中心的な概念を理解するには、パーシャル･フレームバッファを使用してメモリ要件を軽減する方法に関する<a href="/4.16/ja/docs/development/scenarios/lowering-memory-usage-with-partial-framebuffer">専門の記事</a>を参照してください。 この記事はパーシャル･フレームバッファを実現する方法を概念的に示したものなので、この記事に示すコードはTouchGFX Generatorによって生成されるコードと少し異なっています。 これらの戦略で生成されるコードの具体例については、「<a href="/4.16/ja/docs/development/touchgfx-hal-development/scenarios/scenarios-framebuffer-strategies">フレームバッファ戦略</a>」を参照してください。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="driver">Driver<a class="hash-link" href="#driver" title="Direct link to heading">​</a></h2><p>［Driver］セクションでは、TouchGFX ALのさまざまな役割に対応するドライバを開発者が選択できます。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="application-tick-source">Application Tick Source<a class="hash-link" href="#application-tick-source" title="Direct link to heading">​</a></h3><p>アプリケーションのティック･ソースは、アプリケーションを前進させる方法を定義します。 開発者は以下のオプションを使用できます。</p><ul><li><strong>LTDC</strong> - ［Display］グループの［Interface］で［LTDC］を選択した場合、［Application Tick Source］を［LTDC］にできます。 つまり、TouchGFX Generatorが<code>TouchGFXGeneratedHAL</code> クラスにドライバ関数(LTDC割込みハンドラ)をインストールし、それが<code>OSWrappers::signalVSync()</code>.を呼び出してアプリケーションを前進させます。</li><li><strong>Custom</strong> - この場合、<code>OSWrappers::signalVSync()</code> を繰り返し呼び出すことでアプリケーションを前進させるハンドラを、開発者が実装する必要があります。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="graphics-accelerator">Graphics Accelerator<a class="hash-link" href="#graphics-accelerator" title="Direct link to heading">​</a></h3><p>グラフィック･アクセラレーションに関して、開発者には次の3つのオプションがあります。</p><ul><li><strong>None</strong>- アプリケーションはCPUのみを使用してフレームをレンダリングします。</li><li><strong>Chrom-ART (DMA2D)</strong> - アプリケーションは可能であればChrom-ART機能を使用してピクセルの移動やブレンドを行い、CPUサイクルを解放します。 TouchGFX Generatorによってドライバがインストールされるので、開発者によるアクションは必要ありません。</li></ul><p>TouchGFX Generatorから提供されるChrom-ART（DMA2D）ドライバは、TransferCompleteInterruptの受信方法として次の2つをサポートしています。</p><ol><li>TM32Cube HALドライバを使用して、dma2dハンドラにコールバック関数<code>hdma2d.XferCpltCallback</code>を登録する。</li><li><code>DMA2D_IRQHandler()</code>割込みハンドラを直接使用する。</li></ol><p>この2つの方法を切り替えるには、DMA2D IP用のCubeMXのNVIC設定で、DMA2Dグローバル割込みを有効化 / 無効化します。 グローバル割込みを有効化するとオプション1のコードが生成され、グローバル割込みを無効化するとオプション2のコードが生成されます。</p><div class="highlight highlight-note"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>Note</h5></div><div class="highlight-content"><li>DMA2Dのグローバル割込みを使用する場合は、「IRQハンドラ」が「DMA2D HALハンドラ」を呼び出すことを確認します。これはデフォルトの動作です。</li><li>グローバル割込みが有効で「IRQハンドラ」とDMA2Dの「HALハンドラの呼び出し」が無効になっている場合、登録されたコールバックが呼び出されません。</li></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="real-time-operating-system">Real-Time Operating System<a class="hash-link" href="#real-time-operating-system" title="Direct link to heading">​</a></h3><p>開発者はTouchGFXで任意のRTOSを使用できます(OS無しも含む)。 「抽象化レイヤ･アーキテクチャ」で説明したように、TouchGFXエンジンはインタフェースを使用して、ユーザが選択したRTOSと、メイン･イベント･ループおよびフレームバッファのアクセスを同期させます。<code>OSWrappers</code></p><p>FreeRTOSはCubeMXおよびTouchGFX Generator内から直接設定可能で、タスク定義とTouchGFX RTOSドライバの両方のユーザ生成のコードを付与します TouchGFX GeneratorではCMSIS V1およびCMSIS V2準拠のRTOSドライバを生成可能で、これは任意のCMSIS準拠のRTOSで機能します。 この場合、開発者はCubeMXを使用してタスク定義のコードを生成できなくなり、<em>ユーザ･コード</em>でこれを行う必要が生じます。</p><p>次の図は、TouchGFX Generatorを通して使用可能なオプションを示しています。</p><div class="figure noshadow"><a href="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/driver-rtos-options.webp" target="_blank"><img width="675" src="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/driver-rtos-options.webp"></a><p>RTOSドライバのオプション</p></div><p>次の関数を呼び出すと、TouchGFXのメイン･ループに入ります。</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">MX_TouchGFX_Process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">void</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>開発者はTouchGFXアプリケーションを実行したいタスクのタスク･ハンドラ内で、この関数を呼び出す必要があります。 次の例は、ユーザがCubeMXから<code>DefaultTask</code> という名前のFreeRTOSタスクを設定した場合に、 <code>MX_TouchGFX_Process()</code>を呼び出して、このタスク･ハンドラのユーザ･コード･セクションでTouchGFXを開始する方法を示しています。</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">StartDefaultTask</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">argument</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* USER CODE BEGIN 5 */</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">MX_TouchGFX_Process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* USER CODE END 5 */</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>FreeRTOSを有効にすると、CubeMXはスケジューラを起動する <code>osKernelStart();</code>の呼び出しも生成します。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="other-cmsis-compliant-os">その他のCMSIS準拠OS<a class="hash-link" href="#other-cmsis-compliant-os" title="Direct link to heading">​</a></h4><p>CubeMXが提供可能なOS（FreeRTOS）以外のCMSIS準拠OSを必要とする開発者は、RTOSの設定とタスク定義を手動で行う必要があります。 一般的には、以下の手動ステップを行う必要があります。</p><ol><li>RTOSを設定する。</li><li>TouchGFXを実行するためのタスクを定義する（<code>MX_TouchGFX_Process</code>）。</li><li>スケジューラを起動する。</li></ol><p>ここでは、 <em>Azure RTOS</em>. 向けにステップ2と3を実行する方法の例を示します。 CubeMXはこの設定の支援ができないので、コードの上書きを防ぐため、提供された<em>ユーザ･コード･セクション</em>内ですべてを設定する必要があります。 以下のコードは、GUIタスク定義の疑似コードを示しています。 一般に、CubeMXで生成されていないコードについては、<code>main.c</code>.ファイル全体に点在する<em>ユーザ･コード･セクション</em>内に配置する必要があります。</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* BEGIN USER CODE SECTION */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(195, 232, 141)">&quot;tx_api.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> </span><span class="token macro property macro-name">GUI_THREAD_STACK_SIZE</span><span class="token macro property">         </span><span class="token macro property expression number" style="color:rgb(247, 140, 108)">1024</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TX_THREAD gui_thread</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">void</span><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">gui_thread_entry</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ULONG thread_input</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//Thread prototype</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* END USER CODE SECTION */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* BEGIN USER CODE SECTION - Choose an appropriate one from main.c */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* Allocate the stack for gui thread  */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">tx_byte_allocate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* Create the gui thread.  */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">tx_thread_create</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">gui_thread</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;GUI Thread&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> gui_thread_entry</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              pointer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> GUI_TASK_STACK_SIZE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> TX_NO_TIME_SLICE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> TX_AUTO_START</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* END USER CODE SECTION*/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>MX_TouchGFX_Process</code> を呼び出して、タスク･ハンドラ内で TouchGFXエンジンのメイン･ループを開始します。</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* BEGIN USER CODE SECTION */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">gui_thread_entry</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ULONG thread_input</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">MX_TouchGFX_Process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* END USER CODE SECTION*/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>スケジューラを起動して、GUIタスクとTouchGFXアプリケーションを起動します。</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* BEGIN USER CODE SECTION */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">tx_kernel_enter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* END USER CODE SECTION*/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="additional-features">Additional features<a class="hash-link" href="#additional-features" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="external-data-reader">External Data Reader<a class="hash-link" href="#external-data-reader" title="Direct link to heading">​</a></h4><p>RGB565フレームバッファ･ピクセル･フォーマットでは、touchgfxは、いわゆる<em>データ･リーダ</em>のインタフェースをサポートしています。これにより開発者は、メモリ内で追加バッファが必要となる<a href="/4.16/ja/docs/development/ui-development/touchgfx-engine-features/caching-bitmaps">キャッシュ</a>を行うのではなく、メモリマップされないシリアルFlashから直接データを読み出せます。 データ･リーダを実装して、メモリマップされないFlashチップからアプリケーション･アセットを取得する方法の例については、<a href="/4.16/ja/docs/development/scenarios/using-serial-flash">シリアルFlash</a>の記事を参照してください。</p><p>通常、<em>データ･リーダ</em>のオプションは、追加バッファ用に十分なメモリを備えていない低コストのソリューション(STM32G0など)で使用されます。 DMA2Dが有効である場合、これは有効化できません。</p><p>フレームバッファのピクセル･フォーマットとして<em>RGB565</em>を選択すると、<em>［Additional Features］</em>グループが使用可能になります。</p><div class="figure noshadow"><a href="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/additional-features-data-reader.webp" target="_blank"><img width="520" src="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/additional-features-data-reader.webp"></a><p>［Additional Features］のデータ･リーダ</p></div><p>開発者は以下の設定を行うことができます。</p><ul><li><strong>External Data Reader</strong>: この機能を有効化または無効化します。 有効化すると、TouchGFXは生成済みのインタフェースを介してアセットのデータを直接取得します。 無効化した場合は、開発者がメモリ内のバッファに画像を<em>キャッシュ</em>する必要があります。</li><li><strong>External Data Reader: Line Buffer Size</strong>: 画像またはテキストをフレームバッファにブレンドするための2つのバッファを作成します。 ARGB8888ピクセル･フォーマットでフル･サイズの画像をサポートするためにデフォルト値は、一画面の幅 x 4バイトです。</li><li><strong>External Data Reader: Minimum DMA transfer size</strong>: DMA転送を開始するために最小限必要なバイト数を設定します。 これより少ないバイト数が要求された場合、DMAは使用されません。</li></ul><p><em>［External Data Reader］</em> を有効にしてコードを生成すると、メモリマップされないFlashからアセットを直接取得できるように以下の追加ファイルが作成されます。</p><ul><li><code>TouchGFX/target/generated/TouchGFXGeneratedDataReader.cpp</code></li><li><code>TouchGFX/target/generated/TouchGFXGeneratedDataReader.hpp</code></li><li><code>TouchGFX/target/TouchGFXDataReader.cpp</code></li><li><code>TouchGFX/target/TouchGFXDataReader.hpp</code></li></ul><p>通常通り、TouchGFX Generatorによって生成されたコードに対して、<code>TouchGFXGeneratedDataReader</code> は読出し専用であり、ユーザの変更は <code>TouchGFXDataReader</code>クラス内で行う必要があります。 <code>TouchGFXGeneratedDataReader</code>のタイプは<code>touchgfx::FlashDataReader</code>.です。</p><p>以下のファイルが変更され、<code>DataReader</code>を使用するようにTouchGFX HALが設定されます。</p><ul><li><code>TouchGFX/target/generated/TouchGFXConfiguration.cpp</code></li><li><code>TouchGFX/target/generated/TouchGFXGeneratedHAL.cpp</code></li><li><code>TouchGFX/target/generated/TouchGFXGeneratedHAL.hpp</code></li></ul><div class="highlight highlight-note"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>Note</h5></div><div class="highlight-content">データ･リーダの［Additional Feature］は、DMA2DとLTDCが無効になっている場合にのみ使用できます。</div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8bit-ltdc-color-look-up-table">8bitLTDCカラー･ルックアップ･テーブル<a class="hash-link" href="#8bit-ltdc-color-look-up-table" title="Direct link to heading">​</a></h4><p>フレームバッファをL8フォーマットで読み出すようにLTDCが設定されており、TouchGFXが <a href="/4.16/ja/docs/api/classes/classtouchgfx_1_1_l_c_d8bpp___a_b_g_r2222">ABRG2222</a>、<a href="/4.16/ja/docs/api/classes/classtouchgfx_1_1_l_c_d8bpp___a_r_g_b2222">ARGB222</a>、<a href="/4.16/ja/docs/api/classes/classtouchgfx_1_1_l_c_d8bpp___b_g_r_a2222">BGRA2222</a>、<a href="/4.16/ja/docs/api/classes/classtouchgfx_1_1_l_c_d8bpp___r_g_b_a2222">RGBA2222</a>のいずれかでレンダリングする場合、TouchGFX Generatorは、<code>TouchGFXHAL::initialize()</code>の実行時にLTDCにロードされるCLUTを提供します。 LTDCおよびCLUTの使用方法の詳細については、STM32マイクロコントローラのリファレンス･マニュアルを参照してください。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="generated-project">生成されるプロジェクト<a class="hash-link" href="#generated-project" title="Direct link to heading">​</a></h2><p>CubeMXで<strong>Generate Code</strong>ボタンを使用してコードを生成する場合、TouchGFXは(少なくとも) 以下のIDEで動作します。</p><ol><li>EWARM</li><li>MDK-ARM</li><li>STM32CubeIDE</li></ol><p>最適なプロジェクト構造を得るために、プロジェクト生成では以下のオプションを選択します。</p><ul><li>［Application structure］:<strong>［Advanced］</strong></li><li><strong>［Generate under root］</strong>無効化(STM32CubeIDEのみ)</li></ul><p>最適なプロジェクト構造を得るために、プロジェクト生成では以下のオプションを選択します。</p><ul><li>［Application structure］:<strong>［Advanced］</strong></li><li><strong>［Generate under root］</strong>無効化(STM32CubeIDEのみ)</li></ul><div class="figure"><a href="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/project-manager.webp" target="_blank"><img src="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/project-manager.webp"></a><p>［Advanced］のアプリケーション構造を選択し、［Generate under root］をオフにする</p></div> CubeMXは以下の構造を持つ*TouchGFX*フォルダも生成します。<div class="figure"><a href="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/folder-b.webp" target="_blank"><img src="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/folder-b.webp"></a><p>TouchGFXフォルダの構造</p></div><ul><li><em>App</em> フォルダには、TouchGFXを初期化し、起動するコードが含まれています。</li><li><em>target</em>フォルダには、読出し専用の生成済みコード（generated/内）と、変更可能なユーザ･クラス(<code>STM32TouchController.cpp</code>、<code>TouchGFXGPIO.cpp</code> および<code>TouchGFXHAL.cpp</code>が含まれています。</li><li><em>.part</em>ファイルは、TouchGFXヘッダ･ファイルとライブラリを完備した完全なTouchGFXプロジェクトを作成するために、TouchGFX Designerを使用して開かれます。partファイルにはピクセル･フォーマットやDesignerがTouchGFXアプリケーション･コードを生成するときに使用するキャンバスの寸法などの関連するアプリケーション情報が含まれています。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="touchgfx-designer-project">TouchGFX Designerプロジェクト<a class="hash-link" href="#touchgfx-designer-project" title="Direct link to heading">​</a></h2><p>以下のコードは、 「<a href="#generated-code-architecture">生成されるコードのアーキテクチャ</a>」セクションで説明した<code>.part</code>ファイルの内容例を示しています。 下記の生成後コマンドでは、TouchGFX Designerで新しいファイル（新しい画面やアセットなど）が作成されると、CubeMXで選択されたプロジェクト(EWARMなど)が更新されます。</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;Application&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;Name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;my_project&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;TouchGfxPath&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;../Middlewares/ST/touchgfx&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;AvailableColorDepths&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">16</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;AvailableLCDs&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;16&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;LCD16bpp&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;AvailableResolutions&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;Width&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">320</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;Height&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">240</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;PostGenerateTargetCommand&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;touchgfx update_project --project-file=../my_project.ioc --platform=m7&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;Version&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;4.13.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>TouchGFX Designerで<em>.part</em> ファイルを開くと、開発者には、具体的なUIをロードするのか、空のテンプレートから開始するのかを選択するオプションが表示されます。</p><div class="figure"><a href="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/choose-ui.webp" target="_blank"><img src="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/choose-ui.webp"></a><p>UIの選択</p></div><p>TouchGFX Designerで<em>［Generate Code］</em>を押すと、TouchGFXフォルダの構造は以下のようになります。 下の画像はTouchGFXフォルダ構造の具体例を示しており、生成後の新しいファイルやフォルダをハイライト表示しています。</p><div class="figure"><a href="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/designer-gen-code.webp" target="_blank"><img src="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/designer-gen-code.webp"></a><p>［Generate Code］</p></div><div class="figure"><a href="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/post-designer-generation.webp" target="_blank"><img src="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/post-designer-generation.webp"></a><p>TouchGFXフォルダの構造</p></div><p>TouchGFXは、CubeMXの.iocファイルから選択されたIDEを検出し(STM32CubeIDE、EWARM、MDK-ARMの場合)、画面の定義や画像およびフォント･アセットなどの新しく生成されたファイルでプロジェクト･ファイルを更新します。</p><p>この時点で開発者は、CubeMX、TouchGFX Designer、およびツールチェーン / IDEで以下のように交互に作業できるようになります。</p><ul><li>CubeMXでIDEプロジェクトのドライバを更新する。</li><li>CubeMXはDesignerで即座に選択したUI関連の変更で、TouchGFX の<em>.part</em>ファイルを更新する。</li><li>CubeMXはTouchGFXが特定のプラットフォーム上で動作するために必要なTouchGFX Generatorの設定に基づいて、HALコード（TouchGFX/target/generated/）を生成する。</li><li>TouchGFX Designerは生成されたコードでプロジェクトを更新する。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="modifying-generated-behavior">生成された動作の変更<a class="hash-link" href="#modifying-generated-behavior" title="Direct link to heading">​</a></h2><p>HALはクラス階層を持つので、CubeMXによって生成されたHALの設定や動作をユーザがオーバーライドできることに留意してください。 以下の例では、開発者が <code>initialize</code> 関数を変更することで、TouchGFXの追加設定や、<code>TouchGFXGeneratedHAL</code>. の既存の設定の変更が可能です。</p><div class="code-header"><div><h5>TouchGFXHAL.cpp</h5></div></div><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">TouchGFXHAL</span><span class="token double-colon punctuation" style="color:rgb(199, 146, 234)">::</span><span class="token function" style="color:rgb(130, 170, 255)">initialize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Calling parent implementation of initialize().</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// To overwrite the generated implementation, omit call to parent function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// and implemented needed functionality here.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Please note, HAL::initialize() must be called to initialize the framework.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token class-name" style="color:rgb(255, 203, 107)">TouchGFXGeneratedHAL</span><span class="token double-colon punctuation" style="color:rgb(199, 146, 234)">::</span><span class="token function" style="color:rgb(130, 170, 255)">initialize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//Overriding configurations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    hal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">lockDMAToFrontPorch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    hal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">setFingerSize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    hal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-projects">プロジェクトのアップグレード<a class="hash-link" href="#upgrading-projects" title="Direct link to heading">​</a></h2><p>TouchGFX Generatorのパラメータは.iocファイル(CubeMXプロジェクト)に格納されます。 TouchGFX Generatorの新バージョンがリリースされると、旧バージョンのパラメータが新バージョンと互換性を持たないために移行が必要になる可能性があります。</p><p>CubeMXはX-CUBEバージョン間のアップグレードをサポートしていないため、<em>［Generate Code］</em>が押されると、<code>.touchgfx</code>ファイルの <code>PostGenerateTargetCommand</code>セクション内の以下のコマンドによってTouchGFX Designerで自動的にアップグレードが実行されます。</p><div class="code-header"><div><h5>.touchgfx</h5></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;PostGenerateTargetCommand&quot; : &quot;touchgfx update_project --project-file=../upgrade.ioc --platform=m7&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>コマンドによって<code>.ioc</code> ファイルが読み出され、現在のバージョンのX-CUBE-TOUCHGFXに合うようにパラメータが更新されます。 次の例は、X-CUBE-TOUCHGFX 4.13.0で作成された.iocファイルで、スクリプト（X-CUBE-TOUCHGFX 4.14.0）を手動で実行する方法を示しています。</p><div class="code-header"><div><h5>STM32F746 DISCOアプリケーション･テンプレートを使用した4.13.0から4.14.0へのアップグレード例</h5></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ touchgfx update_project --project-file=../STM32F746G_DISCO.ioc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  TouchGFX Generator 4.13.0 found</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Creating backup of ../STM32F746G_DISCO.ioc as ../backup_STM32F746G_DISCO.ioc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Performing upgrade 4.13.0 -&gt; 4.14.0 ... OK</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>更新されたプロジェクトをCubeMXで開くと、.iocファイルで示されたバージョンのX-CUBE-TOUCHGFXをインストールするように求められます(まだインストールしていない場合)。 <em>［Download now］</em>をクリックすると、X-Cube-TouchGFX-4.14.0のダウンロードとインストールが行われます。</p><div class="figure"><a href="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/cubemx-additional-software-manager-settings-missing-x-cube-touchgfx-4.14.0.webp" target="_blank"><img src="/4.16/ja/img/development/touchgfx-hal-development/touchgfx-generator/cubemx-additional-software-manager-settings-missing-x-cube-touchgfx-4.14.0.webp"></a><p>追加ソフトウェア･コンポーネントが見つからない場合:</p></div><p>アップグレード･プロセスの実行時、TouchGFX Generatorの設定はすべて保持され、.iocファイルのバックアップは先頭に<code>backup_</code>が付いた状態で、元のファイルと同じ場所に配置されます</p><div class="highlight highlight-note"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>Note</h5></div><div class="highlight-content">TouchGFX Generatorによって提供される新機能を使用するには、CubeMXで<i>［Generate Code］</i>を実行する必要があります。</div></div><div class="highlight highlight-caution"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></div>Caution</h5></div><div class="highlight-content">既存のTouchGFXプロジェクト用にCubeMXを介してX-CUBE-TOUCHGFXをアップグレードするときに、そのアップグレード･プロセスがTouchGFX Designerによって実行されない場合、TouchGFX Generatorのパラメータは別のバージョンに適用されるパラメータであるため、デフォルトにリセットされます。</div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/4.16/ja/docs/development/touchgfx-hal-development/touchgfx-architecture"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">抽象化レイヤ･アーキテクチャ</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/4.16/ja/docs/development/touchgfx-hal-development/scenarios/scenarios-ltdc-parallel-rgb"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">LTDC / パラレルRGB</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#enabling-touchgfx-generator" class="table-of-contents__link toc-highlight">TouchGFX Generatorの有効化</a></li><li><a href="#generated-code-architecture" class="table-of-contents__link toc-highlight">生成されるコードのアーキテクチャ</a></li><li><a href="#feature-overview" class="table-of-contents__link toc-highlight">機能の概要</a></li><li><a href="#display" class="table-of-contents__link toc-highlight">Display</a><ul><li><a href="#interface-and-dimensions" class="table-of-contents__link toc-highlight">インタフェースと寸法</a></li><li><a href="#buffering-strategies" class="table-of-contents__link toc-highlight">Buffering Strategies</a></li></ul></li><li><a href="#driver" class="table-of-contents__link toc-highlight">Driver</a><ul><li><a href="#application-tick-source" class="table-of-contents__link toc-highlight">Application Tick Source</a></li><li><a href="#graphics-accelerator" class="table-of-contents__link toc-highlight">Graphics Accelerator</a></li><li><a href="#real-time-operating-system" class="table-of-contents__link toc-highlight">Real-Time Operating System</a></li><li><a href="#additional-features" class="table-of-contents__link toc-highlight">Additional features</a></li></ul></li><li><a href="#generated-project" class="table-of-contents__link toc-highlight">生成されるプロジェクト</a></li><li><a href="#touchgfx-designer-project" class="table-of-contents__link toc-highlight">TouchGFX Designerプロジェクト</a></li><li><a href="#modifying-generated-behavior" class="table-of-contents__link toc-highlight">生成された動作の変更</a></li><li><a href="#upgrading-projects" class="table-of-contents__link toc-highlight">プロジェクトのアップグレード</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">All rights reserved © 2021 STMicroelectronics | <a href="https://www.st.com/content/st_com/en/common/terms-of-use.html">Terms of use</a> | <a href="https://www.st.com/content/st_com/en/common/privacy-policy.html">Privacy Policy</a> | <a href="/docs/miscellaneous/cookie-policy">Cookie Policy</a> | <a href="https://app-de.onetrust.com/app/#/webform/2b87200d-4023-4588-9df7-ab0cdea1a67e">Exercise your rights</a></div></div></div></footer></div></div>
<script src="/4.16/ja/assets/js/runtime~main.9f8bc7bd.js"></script>
<script src="/4.16/ja/assets/js/main.d5c38302.js"></script>
</body>
</html>