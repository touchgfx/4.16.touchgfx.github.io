<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-development/touchgfx-hal-development/touchgfx-generator">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="search" type="application/opensearchdescription+xml" title="TouchGFX Documentation" href="/4.16/opensearch.xml">
<script src="/4.16/js/one-trust.js"></script>
<script src="/4.16/js/fix-location.js"></script><title data-rh="true">Generator User Guide | TouchGFX Documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://support.touchgfx.com/4.16/img/meta-image.png"><meta data-rh="true" name="twitter:image" content="https://support.touchgfx.com/4.16/img/meta-image.png"><meta data-rh="true" property="og:url" content="https://support.touchgfx.com/4.16/docs/development/touchgfx-hal-development/touchgfx-generator"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Generator User Guide | TouchGFX Documentation"><link data-rh="true" rel="icon" href="/4.16/img/favicon.png"><link data-rh="true" rel="canonical" href="https://support.touchgfx.com/4.16/docs/development/touchgfx-hal-development/touchgfx-generator"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.16/docs/development/touchgfx-hal-development/touchgfx-generator" hreflang="en"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.16/ko/docs/development/touchgfx-hal-development/touchgfx-generator" hreflang="ko"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.16/ja/docs/development/touchgfx-hal-development/touchgfx-generator" hreflang="ja"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.16/zh-CN/docs/development/touchgfx-hal-development/touchgfx-generator" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.16/zh-TW/docs/development/touchgfx-hal-development/touchgfx-generator" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://support.touchgfx.com/4.16/docs/development/touchgfx-hal-development/touchgfx-generator" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://B8LNOI0XWD-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/4.16/assets/css/styles.d56efc44.css">
<link rel="preload" href="/4.16/assets/js/runtime~main.6b031715.js" as="script">
<link rel="preload" href="/4.16/assets/js/main.790851e9.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/4.16/docs/introduction/welcome"><div class="navbar__logo"><img src="/4.16/img/logo.svg" alt="TouchGFX" class="themedImage_ToTc themedImage--light_HNdA"><img src="/4.16/img/logo.svg" alt="TouchGFX" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">English</a><ul class="dropdown__menu"><li><a href="/4.16/docs/development/touchgfx-hal-development/touchgfx-generator" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/4.16/ko/docs/development/touchgfx-hal-development/touchgfx-generator" target="_self" rel="noopener noreferrer" class="dropdown__link">한국어</a></li><li><a href="/4.16/ja/docs/development/touchgfx-hal-development/touchgfx-generator" target="_self" rel="noopener noreferrer" class="dropdown__link">日本語</a></li><li><a href="/4.16/zh-CN/docs/development/touchgfx-hal-development/touchgfx-generator" target="_self" rel="noopener noreferrer" class="dropdown__link">简体中文</a></li><li><a href="/4.16/zh-TW/docs/development/touchgfx-hal-development/touchgfx-generator" target="_self" rel="noopener noreferrer" class="dropdown__link">繁體中文</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/4.16/docs/introduction/welcome">4.16</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/4.16/docs/development/touchgfx-hal-development/touchgfx-generator">4.16</a></li><li><a href="https://support.touchgfx.com/4.15" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.15<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.14" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.14<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://support.touchgfx.com/4.13" target="_blank" rel="noopener noreferrer" class="dropdown__link">4.13<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://community.st.com/s/topic/0TO0X0000003iw6WAA/touchgfx" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community</a><a href="https://touchgfx.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">TouchGFX.com</a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4.16/docs/introduction/welcome">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4.16/docs/basic-concepts/embedded-graphics">Basic Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/4.16/docs/development/development-introduction">Development</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/4.16/docs/development/development-introduction">Development Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/4.16/docs/development/hardware-selection/hardware-selection-introduction">Hardware Selection</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/4.16/docs/development/board-bring-up/board-introduction">Board Bring Up</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/4.16/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction">TouchGFX AL Development</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.16/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction">TouchGFX AL Development Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.16/docs/development/touchgfx-hal-development/touchgfx-architecture">Abstraction Layer Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/4.16/docs/development/touchgfx-hal-development/touchgfx-generator">Generator User Guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/4.16/docs/development/touchgfx-hal-development/scenarios/scenarios-ltdc-parallel-rgb">Scenarios</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/4.16/docs/development/ui-development/ui-development-introduction">UI Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/4.16/docs/development/scenarios/touchgfx-on-lowcost-hardware">Scenarios</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4.16/docs/miscellaneous/updating-to-a-new-touchgfx-version">Miscellaneous</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4.16/docs/tutorials/tutorial-01">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4.16/docs/api/classes/classtouchgfx_1_1_abstract_button">API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/4.16/docs/resources/presentations">Resources</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div id="doc-version-banner-identifier" class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->TouchGFX Documentation<!-- --> <b>4.16</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/development/touchgfx-hal-development/touchgfx-generator">latest version</a></b>.</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><span class="breadcrumbs__link">Development</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">TouchGFX AL Development</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Generator User Guide</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Generator User Guide</h1></header><p>TouchGFX Generator, a part of X-CUBE-TOUCHGFX, is a CubeMX Additional-Software component that helps developers configure TouchGFX to run on their hardware platform. Based on existing CubeMX settings and user input TouchGFX Generator will generate the files required to configure a working TouchGFX application. They include files for TouchGFX HAL, TouchGFX OSAL and TouchGFX Configuration.</p><p>Once code is generated through CubeMX, the TouchGFX project can be opened through TouchGFX Designer where the UI is developed. TouchGFX Designer automatically adds any additional generated code files to the target IDE project that was configured for the project in CubeMX.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="enabling-touchgfx-generator">Enabling TouchGFX Generator<a class="hash-link" href="#enabling-touchgfx-generator" title="Direct link to heading">​</a></h2><p>The following figure shows a project with TouchGFX Generator already enabled under the <em>Additional Software</em> category. Users gain access to adding functionality from X-CUBEs by pressing the &quot;Additional Software&quot; button.</p><div class="figure noshadow"><a href="/4.16/img/development/touchgfx-hal-development/enable-generator.webp" target="_blank"><img src="/4.16/img/development/touchgfx-hal-development/enable-generator.webp"></a><p>Selecting Additional Software in CubeMx</p></div><p>The following figure shows how TouchGFX Generator can be enabled for a project:</p><div class="figure noshadow"><a href="/4.16/img/development/touchgfx-hal-development/add-generator.webp" target="_blank"><img src="/4.16/img/development/touchgfx-hal-development/add-generator.webp"></a><p>Enabling TouchGFX Generator</p></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="generated-code-architecture">Generated Code Architecture<a class="hash-link" href="#generated-code-architecture" title="Direct link to heading">​</a></h2><p>Before describing the features of TouchGFX Generator it is important to understand the architecture of the generated code and how developers can use it to customize configuration and behavior.</p><p>Handwritten user code in files generated by CubeMX is protected through the use of <strong>User Code</strong> sections placed strategically throughout the code generated by CubeMX (C code). In the code generated by TouchGFX Generator (C++ code) this flexibility is accomplished through inheritance.</p><p>When TouchGFX Generator is added through <em>Additional Software</em> and enabled, CubeMX will always create a <em>TouchGFX</em> folder for the project. The folder always contains the same files, regardless of configuration, while the content of the files changes according to CubeMX and User configuration.</p><p>The listing below shows an overview of the content of a CubeMX project with TouchGFX Generator <em>enabled</em>, with emphasis on TouchGFX related files. The table following the list outlines the responsibility of the most important entries.</p><div class="code-header"><div><h5>TouchGFX Folder</h5></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   .mxproject</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   myproject.ioc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├───Core</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├───Drivers</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├───EWARM</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├───Middlewares</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">└───TouchGFX</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    │   ApplicationTemplate.touchgfx.part</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ├───App</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    │       app_touchgfx.c</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    │       app_touchgfx.h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    └───target</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │   STM32TouchController.cpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │   STM32TouchController.hpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │   TouchGFXGPIO.cpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │   TouchGFXHAL.cpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │   TouchGFXHAL.hpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        └───generated</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                OSWrappers.cpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                TouchGFXConfiguration.cpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                TouchGFXGeneratedHAL.cpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                TouchGFXGeneratedHAL.hpp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>Folder</th><th>Responsibility</th></tr></thead><tbody><tr><td>myproject.ioc</td><td>CubeMX Project file</td></tr><tr><td>Core</td><td><code>main.c</code> and startup code</td></tr><tr><td>Drivers</td><td>CMSIS and MCU family drivers</td></tr><tr><td>EWARM</td><td>IDE project folder. Can be EWARM, MDK-ARM or STM32CubeIDE</td></tr><tr><td>Middlewares</td><td>Contains TouchGFX library/headerfiles and third party software like FreeRTOS.</td></tr><tr><td>ApplicationTemplate.touchgfx.part</td><td>The .part file is updated by CubeMX with information that is relevant to TouchGFX Designer project, e.g. screen dimensions and bit depth</td></tr><tr><td>App</td><td>X-CUBE interface to CubeMX. <code>app_touchgfx.c</code> contains definitions for the functions <code>MX_TouchGFX_Process(void)</code> and <code>MX_TouchGFX_Init(void)</code> which are used to initialize TouchGFX and start its main loop.</td></tr><tr><td>target/generated</td><td>This sub-folder contains the read-only files that get overwritten by CubeMX when configurations change. <code>TouchGFXGeneratedHAL.cpp</code> is a sub-class of the TouchGFX class <code>HAL</code> and contains the code that CubeMX can generate based on its current configuration. <code>OSWrappers.cpp</code> (The OSAL) contains the functions required to synchronize with TouchGFX Engine, and finally <code>TouchGFXConfiguration.cpp</code> which contains the code to construct and configure TouchGFX, including the HAL.</td></tr><tr><td>target</td><td>Contains the bulk of files that can be modified by the user to extend the behavior of the HAL or to override configurations generated by CubeMX. <code>STM32TouchController.cpp</code> contains an empty touch controller interface. <code>TouchGFXHAL.cpp</code> defines a sub-class, <code>TouchGFXHAL</code>, of <code>TouchGFXGeneratedHAL</code>.</td></tr></tbody></table><p>It is important to know that <code>TouchGFXConfiguration.cpp</code> contains a function that constructs the HAL and a function that starts the main loop of TouchGFX. Additional configuration can be done in the editable user-class <code>TouchGFXHAL</code>. The general architecture of the HAL is seen below:</p><div class="figure noshadow"><a href="/4.16/img/development/touchgfx-hal-development/code-architecture.webp" target="_blank"><img width="200" src="/4.16/img/development/touchgfx-hal-development/code-architecture.webp"></a><p>Hierarchy of generated code</p></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="feature-overview">Feature Overview<a class="hash-link" href="#feature-overview" title="Direct link to heading">​</a></h2><p>Having enabled TouchGFX Generator, three groups exist in the user interface:</p><ul><li><strong><em>Dependencies</em></strong> - This group contains notifications to the developer about dependencies, warnings or concrete errors in the configuration. The group is hidden if no entries exist.</li><li><strong><em>Display</em></strong> - This group contains settings related to display such as interface, framebuffer bitdepth, width and height. These settings directly impact the size of the canvas of the TouchGFX project as well as the code generated for assets.</li><li><strong><em>Driver</em></strong> - This group allows the user to opt-in for a number of ready-made drivers related to the tick source of the application, graphics acceleration and RTOS. Since CubeMX supports FreeRTOS (CMSIS RTOS v1 and v2) configurations, TouchGFX Generator provides drivers for each of these options.</li></ul><div class="figure noshadow"><a href="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/three-sections.webp" target="_blank"><img src="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/three-sections.webp"></a><p>TouchGFX Generator has three groups: Dependencies, Display, Driver</p></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="display">Display<a class="hash-link" href="#display" title="Direct link to heading">​</a></h2><p>The <em>Display</em> group contains configurations related to display, such as interface, dimensions and buffering strategies.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="interface-and-dimensions">Interface and dimensions<a class="hash-link" href="#interface-and-dimensions" title="Direct link to heading">​</a></h3><p>Multiple display interfaces are usable today with STM32 microcontrollers, e.g.:</p><ul><li>Parallel RGB</li><li>MIPI DSI</li><li>FMC</li><li>SPI</li></ul><p>In the case of MCUs with an LTDC <em>TouchGFX Generator</em> can generate a driver to transfer the framebuffer to the connected display. For DSI, FMC and SPI interfaces drivers must be implemented by developers themselves.</p><div class="highlight highlight-further-reading"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>Further reading</h5></div><div class="highlight-content">See section <a href="/4.16/docs/development/touchgfx-hal-development/scenarios/scenarios-ltdc-parallel-rgb">Scenarios</a> for concrete examples of drivers for different display interfaces.</div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="buffering-strategies">Buffering Strategies<a class="hash-link" href="#buffering-strategies" title="Direct link to heading">​</a></h3><p>The following frame buffer strategies can be configured through TouchGFX generator:</p><ul><li><strong>Single Buffer</strong> - Use only one application frame buffer. Possibly limits performance but uses less memory. Can be used with the &quot;Buffer Location&quot; configuration to place it in internal RAM. For further optimization the user can define a function that returns the current line being processed by the display controller. This method is used by the framework to allow updates to memory that has already been transferred to the display during this frame.</li><li><strong>Double Buffer</strong> - Use two frame buffers. Usually allows for better performance at the cost of memory.</li><li><strong>Partial Buffer</strong> - Use one or more user defined chunks of memory as the frame buffer. This strategy is targeted at low cost solutions that do not rely on external RAM, but have displays for which a full frame buffer would exceed available memory.</li></ul><p>In the case of Single Buffer and Double Buffer users are allowed to configure their location through the &quot;Buffer Location&quot; configuration which offers the following options:</p><ul><li><strong>By Allocation</strong> - Lets the linker place frame buffer memory according to linker script. Default is in internal RAM.</li><li><strong>By Address</strong> - Allows the user to define one (Single) or two (Double) frame buffer addresses.</li></ul><p>The <strong>Partial Buffer</strong> strategy allows the user to define the following parameters:</p><ul><li>Number of blocks (always placed in internal RAM)</li><li>Block size (bytes)</li></ul><p>To understand some core concepts regarding the Partial Buffer strategy please read the <a href="/4.16/docs/development/scenarios/lowering-memory-usage-with-partial-framebuffer">dedicated article</a> on Lowering Memory requirements using partial Frame Buffers. The article shows, conceptually, how to achieve partial frame buffers and the code shown in this article will differ slightly from what is generated by TouchGFX Generator.
Please see <a href="/4.16/docs/development/touchgfx-hal-development/scenarios/scenarios-framebuffer-strategies">Frame Buffer Strategies</a> for concrete examples of the generated code for these strategies.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="driver">Driver<a class="hash-link" href="#driver" title="Direct link to heading">​</a></h2><p>The driver section allows developers to select drivers for various responsibilities of a TouchGFX AL.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="application-tick-source">Application Tick Source<a class="hash-link" href="#application-tick-source" title="Direct link to heading">​</a></h3><p>The application tick source for an application defines how to drive an application forward. The developer has the following options:</p><ul><li><strong>LTDC</strong> - If LTDC is selected as the Interface in the &quot;Display&quot; group the Application Tick Source can be &quot;LTDC&quot;. This means that TouchGFX Generator will install a driver function (LTDC interrupt handler) in <code>TouchGFXGeneratedHAL</code> class that drives the application forward by calling <code>OSWrappers::signalVSync()</code>.</li><li><strong>Custom</strong> - In this case, the developer is required to implement a handler that drives the application forward by calling <code>OSWrappers::signalVSync()</code> repeatedly.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="graphics-accelerator">Graphics Accelerator<a class="hash-link" href="#graphics-accelerator" title="Direct link to heading">​</a></h3><p>The developer has three options when it comes to graphics acceleration:</p><ul><li><strong>None</strong> - The application uses only the CPU to render frames.</li><li><strong>Chrom-ART (DMA2D)</strong> - The application uses the Chrom-ART chip when possible to move and blend pixels, freeing up CPU cycles. The driver is installed by TouchGFX Generator and does not require any action from the developer.</li></ul><p>The Chrom-ART (DMA2D) driver supplied by TouchGFX Generator supports two ways of receiving a TransferCompleteInterrupt.</p><ol><li>Uses the STM32Cube HAL driver where it registers a callback funtion to the dma2d handle <code>hdma2d.XferCpltCallback</code>.</li><li>Uses the <code>DMA2D_IRQHandler()</code> interrupt handler directly.</li></ol><p>Switching between these two is done by enabling or disabling the DMA2D global interrupt in the NVIC Settings in CubeMX for DMA2D IP. Enabling the global interrupt generated code for option 1), disabling the global interrupt generates code for option 2).</p><div class="highlight highlight-note"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>Note</h5></div><div class="highlight-content"><li>When using global interrupt for DMA2D, ensure that the &quot;IRQ handler&quot; calls the &quot;DMA2D HAL handler&quot;, this is default behaviour.</li><li>If disabling &quot;IRQ handler&quot; and &quot;Call HAL handler&quot; for DMA2D while global interrupt is enabled will cause the registered callback to never be called.</li></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="real-time-operating-system">Real-Time Operating System<a class="hash-link" href="#real-time-operating-system" title="Direct link to heading">​</a></h3><p>Developers can use any RTOS with TouchGFX (even No OS). As described in the Abstraction Layer Architecture the TouchGFX Engine uses the <code>OSWrappers</code> interface to synchronize its main event loop as well as framebuffer access with the users choice of RTOS.</p><p>FreeRTOS can be configured directly from within CubeMX and the TouchGFX Generator granting the user generated code for both task definitions and TouchGFX RTOS driver. TouchGFX Generator can generate CMSIS V1 and CMSIS V2 compliant RTOS drivers which work with any CMSIS compliant RTOS. In this case, developers cannot rely on CubeMX for code generation of task definitions and this must be done in <em>user code</em>.</p><p>The following figure shows the options available through the TouchGFX Generator.</p><div class="figure noshadow"><a href="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/driver-rtos-options.webp" target="_blank"><img width="675" src="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/driver-rtos-options.webp"></a><p>RTOS driver options</p></div><p>The TouchGFX main loop is entered when calling the following function.</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">MX_TouchGFX_Process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">void</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Developers are required to call this function in the task handler for the task they intend to run the TouchGFX application in. If the user configured a FeeRTOS task from CubeMX called <code>DefaultTask</code> then the following example shows how <code>MX_TouchGFX_Process()</code> is called to start TouchGFX in the user code section of its task handler.</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">StartDefaultTask</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">argument</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* USER CODE BEGIN 5 */</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">MX_TouchGFX_Process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* USER CODE END 5 */</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When FreeRTOS is enabled, CubeMX will also generate a call to <code>osKernelStart();</code> which starts the scheduler.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="other-cmsis-compliant-os">Other CMSIS compliant OS<a class="hash-link" href="#other-cmsis-compliant-os" title="Direct link to heading">​</a></h4><p>When developers require a different CMSIS compliant OS than what CubeMX can offer (FreeRTOS) he must perform RTOS configuration and task definition manually. Generally, the following manual steps are required:</p><ol><li>Configure the RTOS</li><li>Define a task to run TouchGFX (<code>MX_TouchGFX_Process</code>)</li><li>Start the scheduler</li></ol><p>Here&#x27;s an example of how to perform steps 2 and 3 for <em>Azure RTOS</em>. Since CubeMX cannot help with any of this configuration everything must be done in the provided <em>user code sections</em> to avoid code being overwritten. The following code shows pseudo code for the GUI task definition. Generally, any code that is not generated by CubeMX should be placed in <em>user code sections</em> that are scattered throughout the file <code>main.c</code>.</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* BEGIN USER CODE SECTION */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(195, 232, 141)">&quot;tx_api.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="font-style:italic">define</span><span class="token macro property"> </span><span class="token macro property macro-name">GUI_THREAD_STACK_SIZE</span><span class="token macro property">         </span><span class="token macro property expression number" style="color:rgb(247, 140, 108)">1024</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TX_THREAD gui_thread</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">void</span><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">gui_thread_entry</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ULONG thread_input</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//Thread prototype</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* END USER CODE SECTION */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* BEGIN USER CODE SECTION - Choose an appropriate one from main.c */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* Allocate the stack for gui thread  */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">tx_byte_allocate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* Create the gui thread.  */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">tx_thread_create</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">gui_thread</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;GUI Thread&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> gui_thread_entry</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              pointer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> GUI_TASK_STACK_SIZE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> TX_NO_TIME_SLICE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> TX_AUTO_START</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* END USER CODE SECTION*/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Call <code>MX_TouchGFX_Process</code> to start the TouchGFX Engine Main Loop inside the task handler.</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* BEGIN USER CODE SECTION */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">gui_thread_entry</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ULONG thread_input</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">MX_TouchGFX_Process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* END USER CODE SECTION*/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Start the scheduler to start the GIU task and your TouchGFX Application.</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* BEGIN USER CODE SECTION */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">tx_kernel_enter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* END USER CODE SECTION*/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="additional-features">Additional features<a class="hash-link" href="#additional-features" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="external-data-reader">External Data Reader<a class="hash-link" href="#external-data-reader" title="Direct link to heading">​</a></h4><p>For the RGB565 Framebuffer Pixel Format touchgfx supports a so called <em>Data Reader</em> interface that allows developers to read data directly from a non-memory-mapped serial flash instead of <a href="/4.16/docs/development/ui-development/touchgfx-engine-features/caching-bitmaps">caching</a> which comes at the cost of an additional buffer in memory. Please see the <a href="/4.16/docs/development/scenarios/using-serial-flash">SerialFlash</a> article for a example on how to implement a DataReader to retrieve application assets from a non-memory mapped flash chip.</p><p>The <em>Data Reader</em> option is typically used for low cost solutions (e.g. STM32G0) that do not have enough memory for additional buffers. It cannot be enabled if DMA2D is also enabled.</p><p>Once <em>RGB565</em> is selected as the Framebuffer Pixel Format, <em>Additional Features</em> group becomes available.</p><div class="figure noshadow"><a href="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/additional-features-data-reader.webp" target="_blank"><img width="520" src="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/additional-features-data-reader.webp"></a><p>Additional Features: Data Reader</p></div><p>The following configurations can be made by the developer:</p><ul><li><strong>External Data Reader</strong>: Enable or Disable the feature. Enabling will cause TouchGFX to retrieve data for assets directly through the generated interface. If disabled, developers are then required to <em>cache</em> images to a buffer in memory instead.</li><li><strong>External Data Reader: Line Buffer Size</strong>: Creates two buffers for blending images or text into the framebuffer. Default value is one screen width*4 bytes to support full size images in ARGB8888 pixel format.</li><li><strong>External Data Reader: Minimum DMA transfer size</strong>: Set minimum required bytes to start a DMA transfer. If fewer bytes are requested, DMA will not be used.</li></ul><p>After generating code with <em>External Data Reader</em> enabled, the following, additional files are created to support the retrieval of assets directly from a non-memory mapped flash.</p><ul><li><code>TouchGFX/target/generated/TouchGFXGeneratedDataReader.cpp</code></li><li><code>TouchGFX/target/generated/TouchGFXGeneratedDataReader.hpp</code></li><li><code>TouchGFX/target/TouchGFXDataReader.cpp</code></li><li><code>TouchGFX/target/TouchGFXDataReader.hpp</code></li></ul><p>As usual, for code generated by TouchGFX Generator, <code>TouchGFXGeneratedDataReader</code> is read-only and user modifications should be made inside the <code>TouchGFXDataReader</code> class. <code>TouchGFXGeneratedDataReader</code> is of type <code>touchgfx::FlashDataReader</code>.</p><p>Modifications will be made to the following files to configure TouchGFX HAL to use the <code>DataReader</code>.</p><ul><li><code>TouchGFX/target/generated/TouchGFXConfiguration.cpp</code></li><li><code>TouchGFX/target/generated/TouchGFXGeneratedHAL.cpp</code></li><li><code>TouchGFX/target/generated/TouchGFXGeneratedHAL.hpp</code></li></ul><div class="highlight highlight-note"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>Note</h5></div><div class="highlight-content">The DataReader Additional Feature is only available if DMA2D and LTDC are disabled.</div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8bit-ltdc-color-look-up-table">8bit LTDC Color Look-up Table<a class="hash-link" href="#8bit-ltdc-color-look-up-table" title="Direct link to heading">​</a></h4><p>When the LTDC is configured to read the framebuffer in L8 format and TouchGFX renders in either <a href="/4.16/docs/api/classes/classtouchgfx_1_1_l_c_d8bpp___a_b_g_r2222">ABRG2222</a>, <a href="/4.16/docs/api/classes/classtouchgfx_1_1_l_c_d8bpp___a_r_g_b2222">ARGB222</a>, <a href="/4.16/docs/api/classes/classtouchgfx_1_1_l_c_d8bpp___b_g_r_a2222">BGRA2222</a>, or <a href="/4.16/docs/api/classes/classtouchgfx_1_1_l_c_d8bpp___r_g_b_a2222">RGBA2222</a>, TouchGFX Generator will provide a CLUT which is loaded into the LTDC during <code>TouchGFXHAL::initialize()</code>. Please refer to the STM32 MCU reference manual for more details on usage of LTDC and CLUT.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="generated-project">Generated project<a class="hash-link" href="#generated-project" title="Direct link to heading">​</a></h2><p>TouchGFX works with (at least) the following IDEs when generating code using the <strong>Generate Code</strong> button in CubeMX:</p><ol><li>EWARM</li><li>MDK-ARM</li><li>STM32CubeIDE</li></ol><p>For optimal project structure select the following options for project generation:</p><ul><li>Application structure: <strong>Advanced</strong></li><li>Disable <strong>Generate under root</strong> (STM32CubeIDE only)</li></ul><p>For optimal project structure select the following options for project generation:</p><ul><li>Application structure: <strong>Advanced</strong></li><li>Disable <strong>Generate under root</strong> (STM32CubeIDE only)</li></ul><div class="figure"><a href="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/project-manager.webp" target="_blank"><img src="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/project-manager.webp"></a><p>Select Advanced application structure and deselect Generate under root</p></div>CubeMX will also generate a *TouchGFX* folder with the following structure:<div class="figure"><a href="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/folder-b.webp" target="_blank"><img src="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/folder-b.webp"></a><p>TouchGFX folder structure</p></div><ul><li>The <em>App</em> folder which contains code to initialize and start TouchGFX.</li><li>The <em>target</em> folder which contains read-only, generated code (inside generated/) and modifiable user classes (<code>STM32TouchController.cpp</code>, <code>TouchGFXGPIO.cpp</code> and <code>TouchGFXHAL.cpp</code>)</li><li>The <em>.part</em> file which is opened using the TouchGFX Designer in order to create a full TouchGFX project complete with TouchGFX header files and libraries The part file contains relevant application information such as pixel format, and canvas dimensions that the designer uses when generating TouchGFX application code.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="touchgfx-designer-project">TouchGFX Designer Project<a class="hash-link" href="#touchgfx-designer-project" title="Direct link to heading">​</a></h2><p>The following code is an example of the contents of the <code>.part</code> file mentioned in the <a href="#generated-code-architecture">Generated Code Architecture</a> section. The post-generate command, seen below, will update the project selected in CubeMX (e.g. EWARM) when new files are created by the TouchGFX designer (e.g. new screens and assets).</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;Application&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;Name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;my_project&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;TouchGfxPath&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;../Middlewares/ST/touchgfx&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;AvailableColorDepths&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">16</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;AvailableLCDs&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;16&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;LCD16bpp&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;AvailableResolutions&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;Width&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">320</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;Height&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">240</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;PostGenerateTargetCommand&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;touchgfx update_project --project-file=../my_project.ioc --platform=m7&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token property">&quot;Version&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;4.13.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When opening the <em>.part</em> file with TouchGFX Designer developers are presented with the option to load a concrete UI or start from a blank template.</p><div class="figure"><a href="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/choose-ui.webp" target="_blank"><img src="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/choose-ui.webp"></a><p>Choose UI</p></div><p>After pressing <em>Generate Code</em> in TouchGFX Designer the structure of the TouchGFX folder now looks like the following. The following image shows a concrete example of a TouchGFX folder structure and highlights the files and folders that are new after generation.</p><div class="figure"><a href="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/designer-gen-code.webp" target="_blank"><img src="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/designer-gen-code.webp"></a><p>Generate Code</p></div><div class="figure"><a href="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/post-designer-generation.webp" target="_blank"><img src="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/post-designer-generation.webp"></a><p>TouchGFX Folder Structure</p></div><p>TouchGFX will detect the selected IDE from the .ioc CubeMX file (For STM32CubeIDE, EWARM, MDK-ARM) and update the project file with new, generated files like files for screen definitions, image- and font assets.</p><p>At this point, developers can work interchangeably in CubeMX, TouchGFX Designer and toolchain/IDE where:</p><ul><li>CubeMX updates the IDE project with drivers</li><li>CubeMX updates the TouchGFX <em>.part</em> file with UI related changes that are instantly picked up by the designer</li><li>CubeMX generates HAL code (TouchGFX/target/generated/) based on TouchGFX Generator Configuration necessary for TouchGFX to work on a specific platform.</li><li>The TouchGFX designer updates the project with generated code.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="modifying-generated-behavior">Modifying Generated Behavior<a class="hash-link" href="#modifying-generated-behavior" title="Direct link to heading">​</a></h2><p>It important to know that, due to the class hierarchy of the HAL, users can override HAL configuration or behavior that was generated by CubeMX. In the example below, developers can modify the <code>initialize</code> function to configure TouchGFX additionally or to modify an existing configuration set in <code>TouchGFXGeneratedHAL</code>.</p><div class="code-header"><div><h5>TouchGFXHAL.cpp</h5></div></div><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">TouchGFXHAL</span><span class="token double-colon punctuation" style="color:rgb(199, 146, 234)">::</span><span class="token function" style="color:rgb(130, 170, 255)">initialize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Calling parent implementation of initialize().</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// To overwrite the generated implementation, omit call to parent function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// and implemented needed functionality here.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Please note, HAL::initialize() must be called to initialize the framework.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token class-name" style="color:rgb(255, 203, 107)">TouchGFXGeneratedHAL</span><span class="token double-colon punctuation" style="color:rgb(199, 146, 234)">::</span><span class="token function" style="color:rgb(130, 170, 255)">initialize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//Overriding configurations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    hal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">lockDMAToFrontPorch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    hal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">setFingerSize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    hal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-projects">Upgrading Projects<a class="hash-link" href="#upgrading-projects" title="Direct link to heading">​</a></h2><p>TouchGFX Generator parameters are stored in .ioc files (CubeMX project). When a new version of TouchGFX Generator is released the parameters of the old version may be incompatible with the new version and may require migration.</p><p>Since cubeMX does not support upgrading between X-CUBE versions the upgrade is automatically performed by TouchGFX Designer when <em>Generate Code</em> is pressed due to the following command in the <code>PostGenerateTargetCommand</code> section of the <code>.touchgfx</code> file.</p><div class="code-header"><div><h5>.touchgfx</h5></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;PostGenerateTargetCommand&quot; : &quot;touchgfx update_project --project-file=../upgrade.ioc --platform=m7&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The command will read the <code>.ioc</code> file and update the parameters to fit the current version of X-CUBE-TOUCHGFX. Below is an example of running the script (X-CUBE-TOUCHGFX 4.14.0) by hand on an .ioc file created with X-CUBE-TOUCHGFX 4.13.0.</p><div class="code-header"><div><h5>Upgrade example using STM32F746 DISCO Application Template from 4.13.0 to 4.14.0</h5></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ touchgfx update_project --project-file=../STM32F746G_DISCO.ioc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  TouchGFX Generator 4.13.0 found</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Creating backup of ../STM32F746G_DISCO.ioc as ../backup_STM32F746G_DISCO.ioc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Performing upgrade 4.13.0 -&gt; 4.14.0 ... OK</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Opening the updated project with CubeMX prompts the user to install the version of X-CUBE-TOUCHGFX that is represented by the .ioc file (if not already installed). Clicking <em>Download now</em> will download and install X-Cube-TouchGFX-4.14.0.</p><div class="figure"><a href="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/cubemx-additional-software-manager-settings-missing-x-cube-touchgfx-4.14.0.webp" target="_blank"><img src="/4.16/img/development/touchgfx-hal-development/touchgfx-generator/cubemx-additional-software-manager-settings-missing-x-cube-touchgfx-4.14.0.webp"></a><p>Additional Software Component Missing: TouchGFX Generator 4.14.0</p></div><p>All configurations in TouchGFX Generator will be kept during the upgrade procedure and a backup of the .ioc file will be placed beside the original on prepended with <code>backup_</code>.</p><div class="highlight highlight-note"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>Note</h5></div><div class="highlight-content">To use the new features provided by TouchGFX Generator, <i>Generate Code</i> must be performed in CubeMX.</div></div><div class="highlight highlight-caution"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></div>Caution</h5></div><div class="highlight-content">If upgrading X-CUBE-TOUCHGFX through CubeMX for an existing TouchGFX Project and the upgrade process is not run by TouchGFX Designer, TouchGFX Generator parameters will be reset to default since they are applicable to a different version.</div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/4.16/docs/development/touchgfx-hal-development/touchgfx-architecture"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Abstraction Layer Architecture</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/4.16/docs/development/touchgfx-hal-development/scenarios/scenarios-ltdc-parallel-rgb"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">LTDC/Parallel RGB</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#enabling-touchgfx-generator" class="table-of-contents__link toc-highlight">Enabling TouchGFX Generator</a></li><li><a href="#generated-code-architecture" class="table-of-contents__link toc-highlight">Generated Code Architecture</a></li><li><a href="#feature-overview" class="table-of-contents__link toc-highlight">Feature Overview</a></li><li><a href="#display" class="table-of-contents__link toc-highlight">Display</a><ul><li><a href="#interface-and-dimensions" class="table-of-contents__link toc-highlight">Interface and dimensions</a></li><li><a href="#buffering-strategies" class="table-of-contents__link toc-highlight">Buffering Strategies</a></li></ul></li><li><a href="#driver" class="table-of-contents__link toc-highlight">Driver</a><ul><li><a href="#application-tick-source" class="table-of-contents__link toc-highlight">Application Tick Source</a></li><li><a href="#graphics-accelerator" class="table-of-contents__link toc-highlight">Graphics Accelerator</a></li><li><a href="#real-time-operating-system" class="table-of-contents__link toc-highlight">Real-Time Operating System</a></li><li><a href="#additional-features" class="table-of-contents__link toc-highlight">Additional features</a></li></ul></li><li><a href="#generated-project" class="table-of-contents__link toc-highlight">Generated project</a></li><li><a href="#touchgfx-designer-project" class="table-of-contents__link toc-highlight">TouchGFX Designer Project</a></li><li><a href="#modifying-generated-behavior" class="table-of-contents__link toc-highlight">Modifying Generated Behavior</a></li><li><a href="#upgrading-projects" class="table-of-contents__link toc-highlight">Upgrading Projects</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">All rights reserved © 2021 STMicroelectronics | <a href="https://www.st.com/content/st_com/en/common/terms-of-use.html">Terms of use</a> | <a href="https://www.st.com/content/st_com/en/common/privacy-policy.html">Privacy Policy</a> | <a href="/docs/miscellaneous/cookie-policy">Cookie Policy</a> | <a href="https://app-de.onetrust.com/app/#/webform/2b87200d-4023-4588-9df7-ab0cdea1a67e">Exercise your rights</a></div></div></div></footer></div></div>
<script src="/4.16/assets/js/runtime~main.6b031715.js"></script>
<script src="/4.16/assets/js/main.790851e9.js"></script>
</body>
</html>